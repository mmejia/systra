(function(e){"use strict";e.fn.pickAColor=function(t){var n="ontouchstart"in window,r=parseInt(e(window).width(),10)<767?!0:!1,i="localStorage"in window&&window.localStorage!==null&&typeof JSON=="object",s=document.all&&!window.atob,o=n?"touchstart.pickAColor":"mousedown.pickAColor",u=n?"touchmove.pickAColor":"mousemove.pickAColor",a=n?"touchend.pickAColor":"mouseup.pickAColor",f=n?"touchend.pickAColor":"click.pickAColor",l="dragging.pickAColor",c="endDrag.pickAColor",h=e.extend({showSpectrum:!0,showSavedColors:!0,saveColorsPerElement:!1,fadeMenuToggle:!0,showAdvanced:!0,showBasicColors:!0,showHexInput:!0,allowBlank:!1,basicColors:{white:"fff",red:"f00",orange:"f60",yellow:"ff0",green:"008000",blue:"00f",purple:"800080",black:"000"}},t);!h.showAdvanced&&!h.showBasicColors&&(h.showBasicColors=!0);var p=h.showSavedColors&&h.showAdvanced||h.showBasicColors&&h.showSavedColors||h.showBasicColors&&h.showAdvanced,d=function(){var t=e("<div>").addClass("btn-group"),n=e("<button type='button'>").addClass("btn color-dropdown dropdown-toggle"),r=e("<span>").addClass("color-preview current-color"),i=e("<span>").addClass("caret"),o=e("<div>").addClass("color-menu dropdown-menu");h.showHexInput||(n.addClass("no-hex"),o.addClass("no-hex")),t.append(n.append(r).append(i)),!p&&!h.showSpectrum&&o.addClass("small");if(p){var u=e("<div>").addClass("color-menu-tabs"),a=h.showBasicColors?"savedColors-tab tab":"savedColors-tab tab tab-active";h.showBasicColors&&u.append(e("<span>").addClass("basicColors-tab tab tab-active").append(e("<a>").text("Basic Colors"))),h.showSavedColors&&u.append(e("<span>").addClass(a).append(e("<a>").text("Saved Colors"))),h.showAdvanced&&u.append(e("<span>").addClass("advanced-tab tab").append(e("<a>").text("Advanced"))),o.append(u)}if(h.showBasicColors){var f=e("<div>").addClass("basicColors-content active-content");h.showSpectrum&&f.append(e("<h6>").addClass("color-menu-instructions").text("Tap spectrum or drag band to change color"));var l=e("<ul>").addClass("basic-colors-list");e.each(h.basicColors,function(t,n){var r=e("<li>").addClass("color-item"),i=e("<a>").addClass(t+" color-link"),o=e("<span>").addClass("color-preview "+t),u=e("<span>").addClass("color-label").text(t);i.append(o,u),o.append(),n[0]!=="#"&&(n="#"+n),o.css("background-color",n);if(h.showSpectrum){var a=e("<span>").addClass("color-box spectrum-"+t);s&&e.each([0,1],function(r){n!=="fff"&&t!=="000"&&a.append(e("<span>").addClass(t+"-spectrum-"+r+" ie-spectrum"))});var f=e("<span>").addClass("highlight-band");e.each([0,1,2],function(){f.append(e("<span>").addClass("highlight-band-stripe"))}),i.append(a.append(f))}l.append(r.append(i))}),o.append(f.append(l))}if(h.showSavedColors){var c=h.showBasicColors?"inactive-content":"active-content",d=e("<div>").addClass("savedColors-content").addClass(c);d.append(e("<p>").addClass("saved-colors-instructions").text("Type in a color or use the spectrums to lighten or darken an existing color.")),o.append(d)}if(h.showAdvanced){var v=h.showBasicColors||h.showSavedColors?"inactive-content":"active-content",m=e("<div>").addClass("advanced-content").addClass(v).append(e("<h6>").addClass("advanced-instructions").text("Tap spectrum or drag band to change color")),g=e("<ul>").addClass("advanced-list"),y=e("<li>").addClass("hue-item"),b=e("<span>").addClass("hue-text").text("Hue: ").append(e("<span>").addClass("hue-value").text("0")),w=e("<span>").addClass("color-box spectrum-hue");s&&e.each([0,1,2,3,4,5,6],function(t){w.append(e("<span>").addClass("hue-spectrum-"+t+" ie-spectrum hue"))});var E=e("<span>").addClass("highlight-band");e.each([0,1,2],function(){E.append(e("<span>").addClass("highlight-band-stripe"))}),g.append(y.append(b).append(w.append(E)));var S=e("<li>").addClass("lightness-item"),x=e("<span>").addClass("color-box spectrum-lightness"),T=e("<span>").addClass("lightness-text").text("Lightness: ").append(e("<span>").addClass("lightness-value").text("50%"));s&&e.each([0,1],function(t){x.append(e("<span>").addClass("lightness-spectrum-"+t+" ie-spectrum"))});var N=e("<span>").addClass("highlight-band");e.each([0,1,2],function(){N.append(e("<span>").addClass("highlight-band-stripe"))}),g.append(S.append(T).append(x.append(N)));var C=e("<li>").addClass("saturation-item"),k=e("<span>").addClass("color-box spectrum-saturation");s&&e.each([0,1],function(t){k.append(e("<span>").addClass("saturation-spectrum-"+t+" ie-spectrum"))});var L=e("<span>").addClass("highlight-band");e.each([0,1,2],function(){L.append(e("<span>").addClass("highlight-band-stripe"))});var A=e("<span>").addClass("saturation-text").text("Saturation: ").append(e("<span>").addClass("saturation-value").text("100%"));g.append(C.append(A).append(k.append(L)));var O=e("<li>").addClass("preview-item").append(e("<span>").addClass("preview-text").text("Preview")),M=e("<span>").addClass("color-preview advanced").append("<button class='color-select btn btn-mini advanced' type='button'>Select</button>");g.append(O.append(M)),o.append(m.append(g))}return t.append(o),t},v={},m={rowsInDropdown:8,maxColsInDropdown:2};if(h.showSavedColors){var g=[];if(i&&localStorage.allSavedColors)g=JSON.parse(localStorage.allSavedColors);else if(document.cookie.match("pickAColorSavedColors-allSavedColors=")){var y=document.cookie.split(";");e.each(y,function(e){y[e].match("pickAColorSavedColors-allSavedColors=")&&(g=y[e].split("=")[1].split(","))})}}var b={initialize:function(t){var n=e(this),r,i,s;n.attr("name")||n.attr("name","pick-a-color-"+t),i=n.attr("name"),n.addClass("pick-a-color"),h.allowBlank?n.val().match(/^\s+$|^$/)||(v.defaultColor=tinycolor(n.val()).toHex(),v.typedColor=v.defaultColor,n.val(v.defaultColor)):(v.defaultColor=tinycolor(n.val()).toHex(),v.typedColor=v.defaultColor,n.val(v.defaultColor)),e(n).wrap('<div class="input-prepend input-append pick-a-color-markup" id="'+i+'">'),r=e(n.parent()),h.showHexInput?r.prepend('<span class="hex-pound add-on">#</span>').append(d()):r.append(d()),h.showHexInput||n.attr("type","hidden")},updatePreview:function(e){h.allowBlank?(v.typedColor=e.val().match(/^\s+$|^$/)?"":tinycolor(e.val()).toHex(),v.typedColor===""?e.siblings(".btn-group").find(".current-color").css("background","none"):e.siblings(".btn-group").find(".current-color").css("background-color","#"+v.typedColor)):(v.typedColor=tinycolor(e.val()).toHex(),e.siblings(".btn-group").find(".current-color").css("background-color","#"+v.typedColor))},pressPreviewButton:function(){var e=arguments[0].thisEvent;e.stopPropagation(),b.toggleDropdown(e.target)},openDropdown:function(t,r){e(".color-menu").each(function(){var t=e(this);if(t.css("display")==="block"){var n=t.parents(".btn-group");b.closeDropdown(n,t)}}),h.fadeMenuToggle&&!n?e(r).fadeIn("fast"):e(r).show(),e(t).addClass("open")},closeDropdown:function(t,r){h.fadeMenuToggle&&!n?e(r).fadeOut("fast"):e(r).css("display","none"),e(t).removeClass("open")},closeDropdownIfOpen:function(){var e=arguments[0].button,t=arguments[0].menu;t.css("display")==="block"&&b.closeDropdown(e,t)},toggleDropdown:function(t){var n=e(t).parents(".pick-a-color-markup"),r=n.find(".btn-group"),i=n.find(".color-menu");i.css("display")==="none"?b.openDropdown(r,i):b.closeDropdown(r,i)},tabbable:function(){var t=e(this),n=t.parents(".pick-a-color-markup");t.click(function(){var t=e(this),r=t.attr("class").split(" ")[0].split("-")[0]+"-content",i=t.parents(".dropdown-menu").find("."+r);t.hasClass("tab-active")||(n.find(".tab-active").removeClass("tab-active"),n.find(".active-content").removeClass("active-content").addClass("inactive-content"),t.addClass("tab-active"),e(i).addClass("active-content").removeClass("inactive-content"))})},getColorMultiplier:function(t,r,i){var s=i==="basic"?parseInt(e(".color-box").first().width(),10):parseInt(e(".advanced-list").find(".color-box").first().width(),10);s===0&&(i==="basic"?s=n?160:200:s=n?160:300);var o=s/2,u=r/s;return t==="bidirectional"?u<=.5?(1-r/o)/2:-((r-o)/o)/2:t==="darkenRight"?-(u/2):u/2},modifyHSLLightness:function(e,t){var n=e;return n.l+=t,n.l=Math.min(Math.max(0,n.l),1),tinycolor(n).toHslString()},getMoveableArea:function(e){var t={},n=e.parent(),r=e.outerWidth(),i=n.width(),s=n.offset();return t.minX=s.left,t.maxX=i-r,t},moveHighlightBand:function(t,r,i){var s=e(".highlight-band").first().outerWidth(),o=s*.75,u=n?i.originalEvent.pageX:i.pageX,a=u-r.minX-o;a=Math.max(0,Math.min(a,r.maxX)),t.css("position","absolute"),t.css("left",a)},horizontallyDraggable:function(){e(this).on(o,function(t){t.preventDefault();var n=e(t.delegateTarget);n.css("cursor","-webkit-grabbing"),n.css("cursor","-moz-grabbing");var r=b.getMoveableArea(n);e(document).on(u,function(e){n.trigger(l),b.moveHighlightBand(n,r,e)}).on(a,function(t){e(document).off(u),e(document).off(l),n.css("cursor","-webkit-grab"),n.css("cursor","-moz-grab"),n.trigger(c),e(document).off(a)})}).on(a,function(t){t.stopPropagation(),e(document).off(u),e(document).off(l)})},modifyHighlightBand:function(e,t,n){var r={h:0,s:0,l:.05},i={h:0,s:0,l:.5},s=-t,o=s*10,u=e.find(".highlight-band-stripe"),a=n==="lightenRight"?b.modifyHSLLightness(i,s):b.modifyHSLLightness(r,s);e.css("border-color",a),u.css("background-color",a)},calculateHighlightedColor:function(){var t=e(this),n=t.parent(),r=e(".highlight-band").first().outerWidth(),i=r/2,s=arguments[0].type,o,u,a,f,l,c,p,d;if(s==="basic"){var v=n.attr("class").split("-")[2],m=h.basicColors[v];u=tinycolor(m).toHsl();switch(m){case"fff":o="darkenRight";break;case"000":o="lightenRight";break;default:o="bidirectional"}}else{var g=t.parents(".advanced-list");f=arguments[0].hsl.s,p=g.find(".spectrum-hue"),a=arguments[0].hsl.h,c=g.find(".spectrum-saturation"),d=g.find(".lightness-value"),l=g.find(".color-preview"),u={h:arguments[0].hsl.h,l:.5,s:arguments[0].hsl.s},o="bidirectional"}var y=parseInt(t.css("left"),10)+i,w=b.getColorMultiplier(o,y,s),E=b.modifyHSLLightness(u,w),S="#"+tinycolor(E).toHex(),x=E.split("(")[1].split(")")[0].split(",")[2],T=parseInt(x.split("%")[0],10)/100;return s==="basic"?(n.siblings(".color-preview").css("background-color",S),n.prev(".color-label").replaceWith('<button class="color-select btn btn-mini" type="button">Select</button>'),o!=="darkenRight"&&b.modifyHighlightBand(t,w,o)):(l.css("background-color",S),d.text(x),b.updateSaturationStyles(c,a,T),b.updateHueStyles(p,f,T),b.modifyHighlightBand(e(".advanced-content .highlight-band"),w,o)),s==="basic"?tinycolor(E).toHex():T},updateSavedColorPreview:function(t){e.each(t,function(n){var r=e(t[n]),i=r.attr("class");r.find(".color-preview").css("background-color",i)})},updateSavedColorMarkup:function(t,n){n=n?n:g;if(h.showSavedColors&&n.length>0){h.saveColorsPerElement||(t=e(".savedColors-content"),n=g);var r=m.rowsInDropdown*m.maxColsInDropdown;n=n.slice(0,r);var i=e("<ul>").addClass("saved-color-col 0"),s=e("<ul>").addClass("saved-color-col 1");e.each(n,function(t,n){var r=e("<li>").addClass("color-item"),o=e("<a>").addClass(n);o.append(e("<span>").addClass("color-preview")),o.append(e("<span>").addClass("color-label").text(n)),r.append(o),t%2===0?i.append(r):s.append(r)}),t.html(i),t.append(s);var o=e(t).find("a");b.updateSavedColorPreview(o)}},setSavedColorsCookie:function(e,t){var n=new Date,r=31536e7,i=new Date(n.getTime()+r);i=i.toGMTString(),typeof t=="undefined"?document.cookie="pickAColorSavedColors-allSavedColors="+e+";expires="+i:document.cookie="pickAColorSavedColors-"+t+"="+e+"; expires="+i},saveColorsToLocalStorage:function(e,t){if(i)if(typeof t=="undefined")try{localStorage.allSavedColors=JSON.stringify(e)}catch(n){localStorage.clear()}else try{localStorage["pickAColorSavedColors-"+t]=JSON.stringify(e)}catch(n){localStorage.clear()}else b.setSavedColorsCookie(e,t)},removeFromArray:function(t,n){e.inArray(n,t)!==-1&&t.splice(e.inArray(n,t),1)},updateSavedColors:function(e,t,n){b.removeFromArray(t,e),t.unshift(e),b.saveColorsToLocalStorage(t,n)},addToSavedColors:function(e,t,n){if(h.showSavedColors&&e!==undefined){e[0]!="#"&&(e="#"+e),b.updateSavedColors(e,g);if(h.saveColorsPerElement){var r=t.colors,i=t.dataAttr;b.updateSavedColors(e,r,i),b.updateSavedColorMarkup(n,r)}else b.updateSavedColorMarkup(n,g)}},selectFromBasicColors:function(){var t=e(this).find("span:first").css("background-color"),n=arguments[0].els,r=arguments[0].savedColorsInfo;t=tinycolor(t).toHex(),e(n.thisEl).val(t),e(n.thisEl).trigger("change"),b.updatePreview(n.thisEl),b.addToSavedColors(t,r,n.savedColorsContent),b.closeDropdown(n.colorPreviewButton,n.colorMenu)},tapSpectrum:function(){var t=arguments[0].thisEvent,r=arguments[0].savedColorsInfo,i=arguments[0].els,s=arguments[0].mostRecentClick;t.stopPropagation();var o=e(this).find(".highlight-band"),u=b.getMoveableArea(o);n?b.moveHighlightBand(o,u,s):b.moveHighlightBand(o,u,t);var a=b.calculateHighlightedColor.apply(o,[{type:"basic"}]);b.addToSavedColors(a,r,i.savedColorsContent),i.touchInstructions.html("Press 'select' to choose this color")},executeUnlessScrolled:function(){var t=arguments[0].thisFunction,r=arguments[0].theseArguments,i,s;e(this).on(o,function(t){i=e(window).scrollTop(),s=t}).on(f,function(o){var u=i-e(window).scrollTop();if(n&&Math.abs(u)>0)return!1;r.thisEvent=o,r.mostRecentClick=s,t.apply(e(this),[r])})},updateSaturationStyles:function(t,n,r){var i=(r*100).toString()+"%",o="#"+tinycolor("hsl("+n+",0%,"+i).toHex(),u="#"+tinycolor("hsl("+n+",50%,"+i).toHex(),a="#"+tinycolor("hsl("+n+",100%,"+i).toHex(),f="",l=e.each(["-webkit-linear-gradient","-o-linear-gradient"],function(e,t){f+="background-image: "+t+"(left, "+o+" 0%, "+u+" 50%, "+a+" 100%);"}),c="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+o+"', endColorstr='"+u+"', GradientType=1)",h="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+u+"', endColorstr='"+a+"', GradientType=1)";f="background-image: -moz-linear-gradient(left center, "+o+" 0%, "+u+" 50%, "+a+" 100%);"+"background-image: linear-gradient(to right, "+o+" 0%, "+u+" 50%, "+a+" 100%); "+"background-image: -webkit-gradient(linear, left top, right top,"+"color-stop(0, "+o+"),"+"color-stop(0.5, "+u+"),"+"color-stop(1, "+a+"));"+f;if(s){var p=e(t).find(".saturation-spectrum-0"),d=e(t).find(".saturation-spectrum-1");p.css("filter",c),d.css("filter",h)}else t.attr("style",f)},updateLightnessStyles:function(t,n,r){var i=(r*100).toString()+"%",o="#"+tinycolor("hsl("+n+","+i+",100%)").toHex(),u="#"+tinycolor("hsl("+n+","+i+",50%)").toHex(),a="#"+tinycolor("hsl("+n+","+i+",0%)").toHex(),f="",l=e.each(["-webkit-linear-gradient","-o-linear-gradient"],function(e,t){f+="background-image: "+t+"(left, "+o+" 0%, "+u+" 50%, "+a+" 100%);"}),c="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+o+"', endColorstr='"+u+"', GradientType=1)",h="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+u+"', endColorstr='"+a+"', GradientType=1)";f="background-image: -moz-linear-gradient(left center, "+o+" 0%, "+u+" 50%, "+a+" 100%); "+"background-image: linear-gradient(to right, "+o+" 0%, "+u+" 50%, "+a+" 100%); "+"background-image: -webkit-gradient(linear, left top, right top,"+" color-stop(0, "+o+"),"+" color-stop(0.5, "+u+"),"+" color-stop(1, "+a+")); "+f;if(s){var p=e(t).find(".lightness-spectrum-0"),d=e(t).find(".lightness-spectrum-1");p.css("filter",c),d.css("filter",h)}else t.attr("style",f)},updateHueStyles:function(t,n,r){var i=(n*100).toString()+"%",o=(r*100).toString()+"%",u="#"+tinycolor("hsl(0,"+i+","+o+")").toHex(),a="#"+tinycolor("hsl(60,"+i+","+o+")").toHex(),f="#"+tinycolor("hsl(120,"+i+","+o+")").toHex(),l="#"+tinycolor("hsl(180,"+i+","+o+")").toHex(),c="#"+tinycolor("hsl(240,"+i+","+o+")").toHex(),h="#"+tinycolor("hsl(300,"+i+","+o+")").toHex(),p="#"+tinycolor("hsl(0,"+i+","+o+")").toHex(),d="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+u+"', endColorstr='"+a+"', GradientType=1)",v="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+a+"', endColorstr='"+f+"', GradientType=1)",m="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+f+"', endColorstr='"+l+"', GradientType=1)",g="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+l+"', endColorstr='"+c+"', GradientType=1)",y="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+c+"', endColorstr='"+h+"', GradientType=1)",b="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+h+"', endColorstr='"+p+"', GradientType=1)",w="",E=e.each(["-webkit-linear-gradient","-o-linear-gradient"],function(e,t){w+="background-image: "+t+"(left, "+u+" 0%, "+a+" 17%, "+f+" 24%, "+l+" 51%, "+c+" 68%, "+h+" 85%, "+p+" 100%);"});w+="background-image: -webkit-gradient(linear, left top, right top,color-stop(0%, "+u+"),"+"color-stop(17%, "+a+"),"+"color-stop(34%, "+f+"),"+"color-stop(51%, "+l+"),"+"color-stop(68%, "+c+"),"+"color-stop(85%, "+h+"),"+"color-stop(100%, "+p+"));"+"background-image: linear-gradient(to right, "+u+" 0%, "+a+" 17%, "+f+" 24%,"+l+" 51%,"+c+" 68%,"+h+" 85%,"+p+" 100%); "+"background-image: -moz-linear-gradient(left center, "+u+" 0%, "+a+" 17%, "+f+" 24%, "+l+" 51%, "+c+" 68%, "+h+" 85%, "+p+" 100%);";if(s){var S=e(t).find(".hue-spectrum-0"),x=e(t).find(".hue-spectrum-1"),T=e(t).find(".hue-spectrum-2"),N=e(t).find(".hue-spectrum-3"),C=e(t).find(".hue-spectrum-4"),k=e(t).find(".hue-spectrum-5");S.css("filter",d),x.css("filter",v),T.css("filter",m),N.css("filter",g),C.css("filter",y),k.css("filter",b)}else t.attr("style",w)},getHighlightedHue:function(){var t=e(this),r=t.outerWidth(),i=r/2,s=parseInt(t.css("left"),10)+i,o=t.parents(".advanced-list"),u=o.find(".color-preview"),a=o.find(".spectrum-lightness"),f=o.find(".spectrum-saturation"),l=parseInt(o.find(".color-box").first().width(),10),c=o.find(".hue-value"),h=arguments[0].l,p=arguments[0].s,d=(p*100).toString()+"%",v=(h*100).toString()+"%";l===0&&(l=n?160:300);var m=Math.floor(s/l*360),g="hsl("+m+","+d+","+v+")";return g="#"+tinycolor(g).toHex(),u.css("background-color",g),c.text(m),b.updateLightnessStyles(a,m,p),b.updateSaturationStyles(f,m,h),m},getHighlightedSaturation:function(){var t=e(this),r=t.outerWidth(),i=r/2,s=parseInt(t.css("left"),10)+i,o=t.parents(".advanced-list"),u=o.find(".color-preview"),a=o.find(".spectrum-lightness"),f=o.find(".spectrum-hue"),l=o.find(".saturation-value"),c=parseInt(o.find(".color-box").first().width(),10),h=arguments[0].l,p=(h*100).toString()+"%",d=arguments[0].h;c===0&&(c=n?160:300);var v=s/c,m=Math.round(v*100).toString()+"%",g="hsl("+d+","+m+","+p+")";return g="#"+tinycolor(g).toHex(),u.css("background-color",g),l.text(m),b.updateLightnessStyles(a,d,v),b.updateHueStyles(f,v,h),v},updateAdvancedInstructions:function(e){e.html("Press the color preview to choose this color")}};return this.each(function(t){b.initialize.apply(this,[t]);var n={thisEl:e(this),thisWrapper:e(this).parent(),colorTextInput:e(this).find("input"),colorMenuLinks:e(this).parent().find(".color-menu li a"),colorPreviewButton:e(this).parent().find(".btn-group"),colorMenu:e(this).parent().find(".color-menu"),colorSpectrums:e(this).parent().find(".color-box"),basicSpectrums:e(this).parent().find(".basicColors-content .color-box"),touchInstructions:e(this).parent().find(".color-menu-instructions"),advancedInstructions:e(this).parent().find(".advanced-instructions"),highlightBands:e(this).parent().find(".highlight-band"),basicHighlightBands:e(this).parent().find(".basicColors-content .highlight-band")},r,s,o,u;p&&(n.tabs=n.thisWrapper.find(".tab"));if(h.showSavedColors){n.savedColorsContent=n.thisWrapper.find(".savedColors-content");if(h.saveColorsPerElement){u={colors:[],dataObj:e(this).data()},e.each(u.dataObj,function(e){u.dataAttr=e});if(i&&localStorage["pickAColorSavedColors-"+u.dataAttr])u.colors=JSON.parse(localStorage["pickAColorSavedColors-"+u.dataAttr]);else if(document.cookie.match("pickAColorSavedColors-"+u.dataAttr)){var d=document.cookie.split(";");for(var m=0;m<d.length;m++)d[m].match(u.dataAttr)&&(u.colors=d[m].split("=")[1].split(","))}else u.colors=g}}h.showAdvanced&&(o={h:0,s:1,l:.5},n.advancedSpectrums=n.thisWrapper.find(".advanced-list").find(".color-box"),n.advancedHighlightBands=n.thisWrapper.find(".advanced-list").find(".highlight-band"),n.hueSpectrum=n.thisWrapper.find(".spectrum-hue"),n.lightnessSpectrum=n.thisWrapper.find(".spectrum-lightness"),n.saturationSpectrum=n.thisWrapper.find(".spectrum-saturation"),n.hueHighlightBand=n.thisWrapper.find(".spectrum-hue .highlight-band"),n.lightnessHighlightBand=n.thisWrapper.find(".spectrum-lightness .highlight-band"),n.saturationHighlightBand=n.thisWrapper.find(".spectrum-saturation .highlight-band"),n.advancedPreview=n.thisWrapper.find(".advanced-content .color-preview")),b.addToSavedColors(v.defaultColor,u,n.savedColorsContent),b.updatePreview(n.thisEl),n.thisEl.focus(function(){var t=e(this);v.typedColor=t.val(),h.allowBlank||t.val(""),b.toggleDropdown(n.colorPreviewButton,n.ColorMenu)}).blur(function(){var t=e(this);v.newValue=t.val(),v.newValue.match(/^\s+$|^$/)?h.allowBlank||t.val(v.typedColor):(v.newValue=tinycolor(v.newValue).toHex(),t.val(v.newValue),b.addToSavedColors(v.newValue,u,n.savedColorsContent)),b.updatePreview(t)}),b.executeUnlessScrolled.apply(n.colorPreviewButton,[{thisFunction:b.pressPreviewButton,theseArguments:{}}]),b.executeUnlessScrolled.apply(e(document),[{thisFunction:b.closeDropdownIfOpen,theseArguments:{button:n.colorPreviewButton,menu:n.colorMenu}}]),n.colorMenu.on(f,function(e){e.stopPropagation()}),n.thisEl.on(f,function(e){e.stopPropagation()}),b.executeUnlessScrolled.apply(n.colorMenuLinks,[{thisFunction:b.selectFromBasicColors,theseArguments:{els:n,savedColorsInfo:u}}]),p&&b.tabbable.apply(n.tabs),(h.showSpectrum||h.showAdvanced)&&b.horizontallyDraggable.apply(n.highlightBands),h.showSpectrum&&(b.executeUnlessScrolled.apply(n.basicSpectrums,[{thisFunction:b.tapSpectrum,theseArguments:{savedColorsInfo:u,els:n}}]),e(n.basicHighlightBands).on(l,function(e){var t=e.target;b.calculateHighlightedColor.apply(this,[{type:"basic"}])}).on(c,function(e){var t=e.delegateTarget,r=b.calculateHighlightedColor.apply(t,[{type:"basic"}]);b.addToSavedColors(r,u,n.savedColorsContent)})),h.showAdvanced&&(e(n.hueHighlightBand).on(l,function(e){o.h=b.getHighlightedHue.apply(this,[o])}),e(n.lightnessHighlightBand).on(l,function(){b.calculateHighlightedColor.apply(this,[{type:"advanced",hsl:o}])}).on(a,function(){o.l=b.calculateHighlightedColor.apply(this,[{type:"advanced",hsl:o}])}),e(n.saturationHighlightBand).on(l,function(){b.getHighlightedSaturation.apply(this,[o])}).on(c,function(){o.s=b.getHighlightedSaturation.apply(this,[o])}),e(n.advancedHighlightBand).on(c,function(){b.updateAdvancedInstructions(n.advancedInstructions)}),e(n.lightnessSpectrum).click(function(t){t.stopPropagation();var n=e(this).find(".highlight-band"),r=b.getMoveableArea(n);b.moveHighlightBand(n,r,t),o.l=b.calculateHighlightedColor.apply(n,[{type:"advanced",hsl:o}])}),e(n.hueSpectrum).click(function(t){t.stopPropagation();var n=e(this).find(".highlight-band"),r=b.getMoveableArea(n);b.moveHighlightBand(n,r,t),o.h=b.getHighlightedHue.apply(n,[o])}),e(n.saturationSpectrum).click(function(t){t.stopPropagation();var n=e(this).find(".highlight-band"),r=b.getMoveableArea(n);b.moveHighlightBand(n,r,t),o.s=b.getHighlightedSaturation.apply(n,[o])}),e(n.advancedSpectrums).click(function(){b.updateAdvancedInstructions(n.advancedInstructions)}),e(n.advancedPreview).click(function(){var t=tinycolor(e(this).css("background-color")).toHex();e(n.thisEl).val(t),e(n.thisEl).trigger("change"),b.updatePreview(n.thisEl),b.addToSavedColors(t,u,n.savedColorsContent),b.closeDropdown(n.colorPreviewButton,n.colorMenu)})),h.showSavedColors&&(e(n.savedColorsContent).click(function(t){var r=e(t.target);if(r.is("SPAN")||r.is("A")){var i=r.is("SPAN")?r.parent().attr("class").split("#")[1]:r.attr("class").split("#")[1];e(n.thisEl).val(i),e(n.thisEl).trigger("change"),b.updatePreview(n.thisEl),b.closeDropdown(n.colorPreviewButton,n.colorMenu),b.addToSavedColors(i,u,n.savedColorsContent)}}),h.saveColorsPerElement?h.saveColorsPerElement&&b.updateSavedColorMarkup(n.savedColorsContent,u.colors):b.updateSavedColorMarkup(n.savedColorsContent,g))})}})(jQuery)