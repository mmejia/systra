// Generated by CoffeeScript 1.6.3
define(['core/sandbox'], function(sandbox) {
  var UpdatePerfil;
  return UpdatePerfil = {
    iniciar: function() {
      var that;
      that = this;
      this.sandbox = new sandbox(this);
      this.formUpdatePerfil = $('#updatePerfil').ajaxForm({
        mod: that,
        success: function(data) {
          return alert('Hola mundo');
        }
      });
      $('#update-perfil').on('click', function(evento) {
        return that.formUpdatePerfil.submit();
      });
      return $.when($.ajax("/catalogos/delegaciones.json"), $.ajax("/catalogos/comandancias.json"), $.ajax("/catalogos/turnos.json")).done(function(delegaciones, comandancias, turnos) {
        window.delegaciones = delegaciones[0];
        window.comandancias = comandancias[0];
        window.turnos = turnos[0];
        that.llenarDelegaciones();
        that.llenarComandancias();
        that.llenarTurnos();
        return that.cargarPerfilEnView();
      });
    },
    actualizarPerfil: function() {
      var datos;
      datos = {
        data: JSON.stringify(window.infraccion)
      };
      console.log(JSON.stringify(window.infraccion));
      return $.ajax({
        type: "POST",
        url: '/infraccion/ventana_reporte_infraccion/',
        dataType: 'html',
        data: datos,
        success: function(res) {
          console.log(res);
          return that.showMensaje("Reporte para imprimir", res);
        }
      });
    },
    cargarPerfilEnView: function() {
      var perfil;
      perfil = window.perfil;
      $('#perf_id').val(perfil.id);
      $('#perf_cobro').val(perfil.cobro);
      $('#perf_nombre').val(perfil.nombre);
      $('#perf_comandancia').val(perfil.comandancia);
      $('#perf_turno').val(perfil.turno);
      $('#perf_delegacion').val(perfil.delegacion);
      $('#perf_comision').val(perfil.comision);
      $('#perf_color').val(perfil.color);
      return $('#perf_tam_tablas').val(perfil.tam_tabla);
    },
    llenarDelegaciones: function() {
      var delegacion, opciones, sel, _i, _len, _ref;
      if (!window.delegaciones) {
        window.cargarDelegaciones(this.llenarDelegaciones);
      } else {
        sel = $('#perf_delegacion').empty();
        opciones = '<option  value="NO">**SELECCIONAR**</option>';
        console.log(window.delegaciones);
        _ref = window.delegaciones;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          delegacion = _ref[_i];
          opciones += '<option value="' + delegacion.delegacion + '">' + delegacion.delegacion + '</option>';
        }
        sel.append(opciones);
      }
    },
    llenarTurnos: function() {
      var opciones, sel, turno, _i, _len, _ref;
      if (!window.turnos) {
        return cargarTurnos(this.llenarTurnos);
      } else {
        sel = $('#perf_turno').html("");
        opciones = '<option  value="NO">**SELECCIONAR**</option>';
        _ref = window.turnos;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          turno = _ref[_i];
          opciones += '<option value="' + turno.turno + '">' + turno.turno + '</option>';
        }
        sel.append(opciones);
      }
    },
    llenarComandancias: function() {
      var comandancia, opciones, sel, _i, _len, _ref;
      if (!window.comandancias) {
        return cargarComandancias(this.llenarComandancias);
      } else {
        sel = $('#perf_comandancia').html("");
        opciones = '<option  value="NO">**SELECCIONAR**</option>';
        _ref = window.comandancias;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          comandancia = _ref[_i];
          opciones += '<option value="' + comandancia.comandancia + '">' + comandancia.comandancia + '</option>';
        }
        sel.append(opciones);
      }
    }
  };
});
