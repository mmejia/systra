// Generated by CoffeeScript 1.6.3
define(['jade!/static/tpl/main/noticia', 'core/sandbox'], function(tpl_noticia, sandbox) {
  var IniciaMain;
  ({
    tpl_noticia: null
  });
  return IniciaMain = {
    iniciar: function() {
      var that;
      that = this;
      this.sandbox = new sandbox(this);
      this.tpl_noticia = tpl_noticia;
      window.client.emit('login', window.profile);
      window.client.emit('get-news');
      window.client.on('tus-noticias', function(data) {
        return that.showUltimasNoticias(data);
      });
      window.client.on('profile-with-preliminares', function(data) {
        return showPreliminares(data);
      });
      window.client.on('last-new', function(data) {
        that.showUltimasNoticias(data);
      });
      window.client.on('refresh-folio', function(data) {
        return that.showUltimoFolio(data);
      });
    },
    showUltimoFolio: function(data) {
      return $('#last-folio').html(data);
    },
    showUltimasNoticias: function(data) {
      var contenido, item, noticias, _i, _len, _ref;
      contenido = '';
      noticias = data.noticias;
      $('#num_noticias').html(data.length);
      _ref = data.reverse();
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        item = _ref[_i];
        contenido += this.tpl_noticia(item);
      }
      $("#pantalla-noticias").html('');
      $("#pantalla-noticias").html(contenido);
    }
  };
});
