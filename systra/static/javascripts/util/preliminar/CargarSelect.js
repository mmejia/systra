// Generated by CoffeeScript 1.6.3
var appendObservaciones, iniciarCalendario, llenarAgentes, llenarCalles, llenarClasAccidentes, llenarColonias, llenarComandancias, llenarDelegaciones, llenarOperativos, llenarPensiones, llenarTipoAccidentes, llenarTipoEventos, llenarTurnos, llenarUnidades, loadOnView;

loadOnView = function() {
  var preliminar;
  preliminar = window.preliminar;
  if (preliminar) {
    $("#folio_pre").val(preliminar.folio_evento);
    $("#fecha_preliminar").val(preliminar.fecha_evento);
    $("#hora_preliminar").val(preliminar.hora_evento);
    $('#delegacion_pre').val(preliminar.delegacion);
    window.actualizarComandanciaValor(preliminar.delegacion);
    $("#comandancia_pre").val(preliminar.comandancia);
    $("#turno_pre").val(preliminar.turno);
    $("#tipo_evento_pre").val(preliminar.tipo_evento);
    $("#clasificacion_pre").val(preliminar.id_clasificacion);
    $("#calle1_pre").val(preliminar.calle1);
    $('#calle2_pre').val(preliminar.calle1);
    $('#ref_pre').val(preliminar.ref);
    $("#colonia_pre").val(preliminar.colonia);
    $("#operativo_pre").val(preliminar.tipo_operativo);
    $("#no_vehiculos_pre").val(preliminar.no_veh_participantes);
    $("#no_detenidos_pre").val(preliminar.no_detenidos);
    $("#no_heridos_pre").val(preliminar.no_heridos);
    $("#no_muertos_pre").val(preliminar.no_muertos);
    $("#pension_pre").val(preliminar.pension);
    $("#no_de_inventario_pre").val(preliminar.no_de_inventario);
    $("#intervino_pre").val(preliminar.agente_intervino);
    $("#unidad_pre").val(preliminar.unidad_intervino);
    return appendObservaciones(preliminar.observaciones_evento);
  }
};

appendObservaciones = function(data) {
  var el, w5ref;
  el = $('#observaciones_pre');
  w5ref = el.data('wysihtml5');
  if (w5ref) {
    w5ref.editor.setValue(data);
  } else {
    el.html(data);
  }
};

window.cargarSelects = function() {
  $('#observaciones_pre').wysihtml5();
  if (!window.preliminar) {
    llenarDelegaciones();
    llenarComandancias();
    llenarTurnos();
    llenarClasAccidentes();
    llenarCalles();
    llenarColonias();
    llenarOperativos();
    llenarTipoEventos();
    llenarAgentes();
    llenarUnidades();
    llenarPensiones();
    iniciarCalendario();
    return window.spinner.stop();
  } else {
    return $.when($.ajax("/catalogos/delegaciones.json"), $.ajax("/catalogos/comandancias.json"), $.ajax("/catalogos/turnos.json"), $.ajax("/catalogos/clasAccidente.json"), $.ajax("/catalogos/calles.json"), $.ajax("/catalogos/colonias.json"), $.ajax("/catalogos/operativos.json"), $.ajax('/catalogos/tipoEventos.json'), $.ajax("/catalogos/CatAgentesNew.json"), $.ajax("/catalogos/TbUnidades2008.json"), $.ajax('/catalogos/pensiones.json')).done(function(delegaciones, comandancias, turnos, clasAccidentes, calles, colonias, operativos, tipoEventos, agentes, unidades, pensiones) {
      window.delegaciones = delegaciones[0];
      window.comandancias = comandancias[0];
      window.turnos = turnos[0];
      window.clasAccidentes = clasAccidentes[0];
      window.calles = calles[0];
      window.colonias = colonias[0];
      window.operativos = operativos[0];
      window.tipoEventos = tipoEventos[0];
      window.catAgentes = agentes[0];
      window.tbUnidades2008 = unidades[0];
      window.pensiones = pensiones[0];
      llenarDelegaciones();
      llenarComandancias();
      llenarTurnos();
      llenarClasAccidentes();
      llenarCalles();
      llenarColonias();
      llenarOperativos();
      llenarTipoEventos();
      llenarAgentes();
      llenarUnidades();
      llenarPensiones();
      iniciarCalendario();
      loadOnView();
      return window.spinner.stop();
    });
  }
};

llenarDelegaciones = function() {
  var delegacion, opciones, sel, _i, _len, _ref;
  if (!window.delegaciones) {
    cargarDelegaciones(llenarDelegaciones);
  } else {
    sel = $('#delegacion_pre').empty();
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    sel.append(opciones);
    _ref = window.delegaciones;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      delegacion = _ref[_i];
      sel.append($('<option>', {
        value: delegacion.delegacion,
        text: delegacion.delegacion
      }));
    }
  }
  window.actualizarComandancia();
};

llenarComandancias = function() {
  var opciones, sel;
  if (!window.comandancias) {
    cargarComandancias(llenarComandancias);
  } else {
    sel = $('#comandancia_pre').html("");
    opciones = '<option  value= "NO">**SELECCIONAR**</option>';
    sel.append(opciones);
  }
};

llenarPensiones = function() {
  var opciones, pension, sel, _i, _len, _ref;
  if (!window.pensiones) {
    cargarPensiones(llenarPensiones);
  } else {
    sel = $('#pension_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.pensiones;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      pension = _ref[_i];
      opciones += '<option value="' + pension.nombre_pension + '">' + pension.nombre_pension + '</option>';
    }
    sel.append(opciones);
  }
};

llenarOperativos = function() {
  var opciones, operativo, sel, _i, _len, _ref;
  if (!window.operativos) {
    cargarOperativos(llenarOperativos);
  } else {
    sel = $('#operativo_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.operativos;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      operativo = _ref[_i];
      opciones += '<option value="' + operativo.descripcion + '">' + operativo.descripcion + '</option>';
    }
    sel.append(opciones);
  }
};

llenarTipoEventos = function() {
  var evento, opciones, sel, _i, _len, _ref;
  if (!window.tipoEventos) {
    cargarTipoEventos(llenarTipoEventos);
  } else {
    sel = $('#tipo_evento_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.tipoEventos;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      evento = _ref[_i];
      opciones += '<option value="' + evento.tipo_evento + '">' + evento.tipo_evento + '</option>';
    }
    sel.append(opciones);
  }
  return;
};

llenarAgentes = function() {
  var agente, agentes, nombre_agentes, str, _i, _len;
  if (!window.profiles) {
    cargarProfiles(llenarAgentes);
  } else {
    nombre_agentes = [];
    agentes = window.profiles;
    for (_i = 0, _len = agentes.length; _i < _len; _i++) {
      agente = agentes[_i];
      str = agente.cobro;
      nombre_agentes.push(str);
    }
    $("#gafete_agente_pre").autocomplete({
      source: nombre_agentes,
      change: function(evento, ui) {
        var p, _j, _len1, _ref, _results;
        _ref = window.profiles;
        _results = [];
        for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
          p = _ref[_j];
          if (p) {
            if (p.cobro === ui.item.value) {
              _results.push($("#nombre_agente_pre").val(p.nombre));
            } else {
              _results.push(void 0);
            }
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      }
    });
  }
};

llenarUnidades = function() {
  var nombre_sector, nombre_unidades, str_sector, str_unidad, unidad, unidades, _i, _len;
  if (!window.tbUnidades2008) {
    cargarTbUnidades2008(llenarUnidades);
  } else {
    nombre_unidades = [];
    nombre_sector = [];
    unidades = window.tbUnidades2008;
    for (_i = 0, _len = unidades.length; _i < _len; _i++) {
      unidad = unidades[_i];
      str_unidad = unidad.no_unidad;
      str_sector = unidad.sector;
      nombre_unidades.push(str_unidad);
    }
    nombre_unidades.push('NINGUNA');
    $("#unidad_pre").autocomplete({
      source: nombre_unidades,
      change: function(evento, ui) {
        var p, _j, _len1, _ref, _results;
        _ref = window.tbUnidades2008;
        _results = [];
        for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
          p = _ref[_j];
          if (p) {
            if (p.no_unidad === ui.item.value) {
              _results.push($("#sector_pre").val(p.sector));
            } else {
              _results.push(void 0);
            }
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      }
    });
  }
};

llenarCalles = function() {
  var calle, nombres, _i, _len, _ref;
  if (!window.calles) {
    cargarCalles(llenarCalles);
  } else {
    nombres = [];
    _ref = window.calles;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      calle = _ref[_i];
      nombres.push(calle.calle);
    }
    $("#calle1_pre").autocomplete({
      source: nombres
    });
    $("#calle2_pre").autocomplete({
      source: nombres
    });
  }
};

llenarColonias = function() {
  var colonia, nombres, _i, _len, _ref;
  if (!window.colonias) {
    cargarColonias(llenarColonias);
  } else {
    nombres = [];
    _ref = window.colonias;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      colonia = _ref[_i];
      nombres.push(colonia.nombre);
    }
    $("#colonia_pre").autocomplete({
      source: nombres
    });
  }
};

llenarTurnos = function() {
  var opciones, sel, turno, _i, _len, _ref;
  if (!window.turnos) {
    return cargarTurnos(llenarTurnos);
  } else {
    sel = $('#turno_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.turnos;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      turno = _ref[_i];
      opciones += '<option value="' + turno.turno + '">' + turno.turno + '</option>';
    }
    sel.append(opciones);
  }
};

llenarClasAccidentes = function() {
  var clasAccidente, opciones, sel, _i, _len, _ref;
  if (!window.clasAccidentes) {
    window.cargarClasAccidentes(llenarClasAccidentes);
  } else {
    sel = $('#clasificacion_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.clasAccidentes;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      clasAccidente = _ref[_i];
      opciones += '<option value="' + clasAccidente.clas + '">' + clasAccidente.clas + '</option>';
    }
    sel.append(opciones);
  }
};

llenarTipoAccidentes = function() {
  var opciones, sel, tipoAccidente, _i, _len, _ref;
  if (!window.tipoAccidentes) {
    window.cargarTipoAccidentes(llenarTipoAccidentes);
  } else {
    sel = $('#tipo_pre').html("");
    opciones = '<option  value="NO">**SELECCIONAR**</option>';
    _ref = window.tipoAccidentes;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      tipoAccidente = _ref[_i];
      opciones += '<option value="' + tipoAccidente.tipo + '">' + tipoAccidente.tipo + '</option>';
    }
    sel.append(opciones);
  }
};

iniciarCalendario = function() {
  $('#date-fecha-preliminar').datetimepicker({
    pickTime: false,
    language: 'es'
  });
  return $('#date-hora-preliminar').datetimepicker({
    pickDate: false,
    language: 'es'
  });
};
